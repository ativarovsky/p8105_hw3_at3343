---
title: "P8105 Homework 3"
author: "Alice Tivarovsky"
date: "10/6/2019"
output: github_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Problem 1

### Instacart Data

Loading data and generating preview: 
```{r}
library(p8105.datasets)
data("instacart")
view(head(instacart, n = 50))
```


The instacart dataset contains 1,384,617 observations and 15 variables. It catalogues instacart orders from October 2017 in New York City. Key variables include order_id (the order identifier), user_id (the customer identifier), product_id (the product name within each order), and order_dow (the day of the week). The first row, for example, is order_id = 1, meaning it was the first order in October 2017, includes (among 7 other items) the item product_name = Bulgarian Yogurt, which was ordered by customer user_id = 112108 on order_dow = 4 (presumably Wednesday). 

### EDA with Instacart Dataset

Counting # of aisles and aisles most commonly ordered from. 
```{r}
pop_aisle = 
  count(instacart, aisle_id) %>% 
  arrange(desc(n))

pop_aisle
```

There are 134 aisles and the aisle most commonly ordered from is aisle 83 (150609 items). 

Keeping only aisles with n > 10,000, creating a plot that shows the number of items ordered in each aisle. 

```{r}

instacart %>% 
  select(aisle_id, product_name) %>% 
  group_by(aisle_id) %>% 
  summarize(n = n()) %>% 
  filter(n > 10000) %>% 
  ggplot(aes(x = aisle_id, y = n)) + geom_point()
 
```

Creating a table showing the three most popular items in each of the aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”. 

```{r}
instacart %>% 
  filter(aisle == c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  select(order_id, aisle, product_name) %>% 
  group_by(aisle, product_name) %>% 
  summarize(n = n()) %>% 
  mutate(product_rank = min_rank(desc(n))) %>% 
  filter(product_rank <= 3) %>% 
  arrange(aisle, product_rank) %>% 
knitr::kable()
```


Make a table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week; format this table for human readers (i.e. produce a 2 x 7 table).

```{r}
instacart %>% 
  filter(product_name == c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
  select(product_name, order_dow, order_hour_of_day) %>% 
  group_by(product_name, order_dow) %>% 
  summarize(mean_hour = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean_hour
  ) %>% 
  knitr::kable()
```



## Problem 2


Loading BRFSS dataset. 
```{r}
library(p8105.datasets)
data("brfss_smart2010")
view(brfss_smart2010)
```

The dataset contains 134,203 observations and 23 variables. 

```{r}
brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  rename(state = locationabbr, county = locationdesc) %>% 
  count(topic = "Overall Health")

```


